schema: '2.0'
stages:
  train:
    cmd: python train.py --config configs/train.yaml
    deps:
    - path: configs/train.yaml
      hash: md5
      md5: 121f247079bdf3aa2a1c0e846655c837
      size: 769
    - path: dataset_split
      hash: md5
      md5: 227624d5fae92ab573537d1c3139312c.dir
      size: 26296402
      nfiles: 430
    - path: train.py
      hash: md5
      md5: 968e80fecda2c55098b03afe80544431
      size: 20172
    params:
      configs/train.yaml:
        data:
          root: ./dataset_split
        mlflow:
          enabled: true
          tracking_uri:
          experiment: u-net-workflow
          run_name:
          tags: {}
          artifact_subdir: artifacts
        model:
          encoder_name: resnet34
          encoder_weights:
          decoder_use_batchnorm: true
          in_channels: 4
          num_classes: 6
        paths:
          output_dir: ./outputs
          model_path: outputs/model.pth
          metrics_path: outputs/metrics.json
          log_file: outputs/log.txt
        training:
          img_size: 256
          batch_size: 16
          epochs: 10
          lr: 0.001
          weight_decay: 0.0001
          num_workers: 4
          seed: 42
          amp: true
          save_best: true
          ignore_index: -1
    outs:
    - path: outputs/metrics.json
      hash: md5
      md5: 3bb5d0cd2baef15a786dafce4c4c7096
      size: 433
    - path: outputs/model.pth
      hash: md5
      md5: dea75abc1fe9ae2affbeee11ee5628b7
      size: 313302533
  evaluate:
    cmd: python evaluate.py
    deps:
    - path: dataset_split
      hash: md5
      md5: 227624d5fae92ab573537d1c3139312c.dir
      size: 26296402
      nfiles: 430
    - path: evaluate.py
      hash: md5
      md5: 1aef93ef98f282ef9952fc7ce02dd57a
      size: 11806
    - path: outputs/model.pth
      hash: md5
      md5: dea75abc1fe9ae2affbeee11ee5628b7
      size: 313302533
    outs:
    - path: outputs/eval
      hash: md5
      md5: e7e8a551f6ca8c935ffc4100cf847d17.dir
      size: 335234
      nfiles: 5
  inference:
    cmd: python inference.py
    deps:
    - path: inference.py
      hash: md5
      md5: 0c56e723dcff3c7cfc8c0007e608aa95
      size: 12267
    - path: outputs/model.pth
      hash: md5
      md5: dea75abc1fe9ae2affbeee11ee5628b7
      size: 313302533
    - path: test_img/area_test1.tif
      hash: md5
      md5: 674cf39e0540d5779bdb337a9c625f0d
      size: 5250810
    outs:
    - path: outputs/infer
      hash: md5
      md5: 83a0b09e1c25ff25112d18876cbdd017.dir
      size: 384995
      nfiles: 6
